diff -Naurp tetex-src-3.0/libs/xpdf/xpdf/Stream.cc tetex-src-3.0.oden/libs/xpdf/xpdf/Stream.cc
--- tetex-src-3.0/libs/xpdf/xpdf/Stream.cc	2010-05-12 06:30:24.000000000 -0400
+++ tetex-src-3.0.oden/libs/xpdf/xpdf/Stream.cc	2010-05-12 06:21:51.000000000 -0400
@@ -323,6 +323,10 @@ ImageStream::ImageStream(Stream *strA, i
   } else {
     imgLineSize = nVals;
   }
+  if (width > INT_MAX / nComps) {
+    // force a call to gmallocn(-1,...), which will throw an exception
+    imgLineSize = -1;
+  }
   imgLine = (Guchar *)gmallocn(imgLineSize, sizeof(Guchar));
   imgIdx = nVals;
 }
diff -Naurp tetex-src-3.0/libs/xpdf/xpdf/XRef.cc tetex-src-3.0.oden/libs/xpdf/xpdf/XRef.cc
--- tetex-src-3.0/libs/xpdf/xpdf/XRef.cc	2010-05-12 06:30:24.000000000 -0400
+++ tetex-src-3.0.oden/libs/xpdf/xpdf/XRef.cc	2010-05-12 06:29:11.000000000 -0400
@@ -56,6 +56,7 @@ ObjectStream::ObjectStream(XRef *xref, i
   objs = NULL;
   objNums = NULL;
   offsets = NULL;
+  ok = gFalse;
 
   if (!xref->fetch(objStrNum, 0, &objStr)->isStream()) {
     goto err1;
@@ -82,6 +83,13 @@ ObjectStream::ObjectStream(XRef *xref, i
     goto err1;
   }
 
+  // this is an arbitrary limit to avoid integer overflow problems
+  // in the 'new Object[nObjects]' call (Acrobat apparently limits
+  // object streams to 100-200 objects)
+  if (nObjects > 1000000) {
+    error(-1, "Too many objects in an object stream");
+    goto err1;
+  }
   objs = new Object[nObjects];
   objNums = (int *)gmallocn(nObjects, sizeof(int));
   offsets = (int *)gmallocn(nObjects, sizeof(int));
@@ -138,10 +146,10 @@ ObjectStream::ObjectStream(XRef *xref, i
   }
 
 //   gfree(offsets);
+  ok = gTrue;
 
  err1:
   objStr.free();
-  return;
 }
 
 ObjectStream::~ObjectStream() {
@@ -815,6 +823,11 @@ Object *XRef::fetch(int num, int gen, Ob
 	delete objStr;
       }
       objStr = new ObjectStream(this, e->offset);
+      if (!objStr->isOk()) {
+	delete objStr;
+	objStr = NULL;
+	goto err;
+      }
     }
     objStr->getObject(e->gen, num, obj);
     break;
diff -Naurp tetex-src-3.0/libs/xpdf/xpdf/XRef.h tetex-src-3.0.oden/libs/xpdf/xpdf/XRef.h
--- tetex-src-3.0/libs/xpdf/xpdf/XRef.h	2010-05-12 06:30:24.000000000 -0400
+++ tetex-src-3.0.oden/libs/xpdf/xpdf/XRef.h	2010-05-12 06:26:35.000000000 -0400
@@ -29,6 +29,8 @@ public:
   // generation 0.
   ObjectStream(XRef *xref, int objStrNumA);
 
+  GBool isOk() { return ok; }
+
   ~ObjectStream();
 
   // Return the object number of this object stream.
@@ -49,6 +51,7 @@ private:
   int *objNums;			// the object numbers (length = nObjects)
   int *offsets;			// the object offsets (length = nObjects)
   Guint firstOffset;
+  GBool ok;
 };
 
 
